# ๐ ุงููุฑุญูุฉ ุงูุซุงูุซุฉ: ูุธุงู ุงููุฑููุงุช ุงููุงูู - ููุชูู โ

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ
ุชู ุงูุงูุชูุงุก ูู **ูุธุงู ุงููุฑููุงุช ุงููุงูู** ุงูุฐู ูุชูุญ ูููุณุชุฎุฏููู ุฑูุน ูุนุฑุถ ูุญุฐู ุงููุณุชูุฏุงุช ุงููุฑุชุจุทุฉ ุจุทูุจุงุช ุงูุชูููู ุจุงุณุชุฎุฏุงู **Cloudflare R2 Storage**.

---

## โจ ุงูููุฒุงุช ุงูููุฌุฒุฉ

### 1. ๐ค ูุธุงู ุฑูุน ุงููููุงุช
- **4 ุฃููุงุน ูู ุงููุฑููุงุช**:
  - ๐ ุตูุฑุฉ ุงููููุฉ
  - ๐ฐ ุชุนุฑูู ุจุงูุฑุงุชุจ
  - ๐ฆ ูุดู ุงูุญุณุงุจ ุงูุจููู (ุขุฎุฑ 3 ุฃุดูุฑ)
  - ๐ ูุฑูู ุฅุถุงูู

- **ูุนุงููุฉ ุงููููุงุช ูุจู ุงูุฑูุน**:
  - ุนุฑุถ ุงูุตูุฑ ุงููุญุฏุฏุฉ ูุจุงุดุฑุฉ
  - ุฃููููุฉ PDF ูููููุงุช ูู ููุน PDF
  - ุนุฑุถ ุงุณู ุงูููู ูุญุฌูู ุจุงูู KB

- **ุงูุชุญูู ูู ุงููููุงุช**:
  - ุญุฏ ุฃูุตู ููุญุฌู: **5 ููุบุงุจุงูุช**
  - ุฃููุงุน ุงููููุงุช ุงููุฏุนููุฉ: `image/*` ู `.pdf`
  - ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ูููููุงุช ุบูุฑ ุงูุตุงูุญุฉ

- **ุดุฑูุท ุงูุชูุฏู**:
  - ุดุฑูุท ุชูุฏู ูุฑุฆู ููู ููู
  - ุฅุดุงุฑุงุช ููููุฉ ูููุฌุงุญ (โ ุฃุฎุถุฑ) ูุงููุดู (โ ุฃุญูุฑ)
  - ุนุฑุถ ุญุงูุฉ ูู ููู: "ุฌุงุฑู ุงูุฑูุน..." โ "โ ุชู ุงูุฑูุน"

### 2. ๐๏ธ ูุธุงู ุนุฑุถ ุงููุฑููุงุช
- **ุตูุญุฉ ุชูุงุตูู ุงูุทูุจ ูุญุณููุฉ**:
  - ุจุทุงูุงุช ููููุฉ ููู ููุน ูุฑูู
  - ุฃููููุงุช ูููุฒุฉ (๐ ุฃุฒุฑูุ ๐ฐ ุฃุฎุถุฑุ ๐ฆ ุจููุณุฌูุ ๐ ุจุฑุชูุงูู)
  - ุญุงูุฉ "ูุชููุฑ" ุฃู "ูู ูุชู ุฑูุน ุงููุฑูู"

- **ุฃุฒุฑุงุฑ ุงูุชุญูู** (3 ุฃุฒุฑุงุฑ ููู ูุฑูู):
  - ๐๏ธ **ุนุฑุถ**: ูุชุญ ุงููุฑูู ูู ูุงูุฐุฉ ุฌุฏูุฏุฉ
  - ๐ฅ **ุชูุฒูู**: ุชุญููู ุงูููู
  - ๐๏ธ **ุญุฐู**: ุญุฐู ุงููุฑูู (ูุน ุชุฃููุฏ)

### 3. ๐๏ธ ูุธุงู ุญุฐู ุงููุฑููุงุช
- **ุญุฐู ุขูู**:
  - ูุทุงูุจุฉ ุจุงูุชุฃููุฏ ูุจู ุงูุญุฐู
  - ุญุฐู ูู R2 Storage ููุงุนุฏุฉ ุงูุจูุงูุงุช
  - ุชุญุฏูุซ ุชููุงุฆู ููุตูุญุฉ ุจุนุฏ ุงูุญุฐู

- **API ูุญุณูู**:
  - ุงุณุชุฎุฑุงุฌ ุชููุงุฆู ูู `request_id` ูููุน ุงููุฑูู ูู ุงููุณุงุฑ
  - ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุชุนููู ุงููููุฉ ุฅูู NULL)
  - ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุดุงููุฉ

### 4. ๐๏ธ ุงูุชุฎุฒูู ูุงูุจููุฉ ุงูุชุญุชูุฉ
- **Cloudflare R2 Storage**:
  - ุชุฎุฒูู ุขูู ูุณุฑูุน
  - ุฃุณูุงุก ูููุงุช ูุฑูุฏุฉ (timestamp-based)
  - ุชูุธูู ุงููููุงุช ุญุณุจ `request_id`

- **ุจููุฉ ุงููุณุงุฑุงุช**:
  ```
  {request_id}/{type}_{timestamp}.{ext}
  
  ูุซุงู:
  15/id_1734302456789.jpg
  15/salary_1734302457123.pdf
  15/bank_statement_1734302458456.png
  ```

- **ุฃุนูุฏุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช**:
  - `id_attachment_url`
  - `salary_attachment_url`
  - `bank_statement_attachment_url`
  - `additional_attachment_url`

---

## ๐จ ุงูุชุตููู ูุงููุงุฌูุฉ

### ๐ฑ ูููุฐุฌ ุฑูุน ุงููููุงุช
```html
<!-- ูุนุงููุฉ ุชููุงุฆูุฉ ูุน ุงูุตูุฑุฉ/ุงูุฃููููุฉ -->
<div id="preview">
  <img src="..." /> ุฃู <i class="fas fa-file-pdf"></i>
  <p>filename.jpg</p>
  <p>245.6 KB</p>
  <i class="fas fa-check-circle text-green-600"></i>
</div>

<!-- ุดุฑูุท ุงูุชูุฏู -->
<div class="progress-bar">
  <span>ุฌุงุฑู ุฑูุน ุตูุฑุฉ ุงููููุฉ...</span>
  <div style="width: 100%" class="bg-green-600"></div>
  <span>โ ุชู ุงูุฑูุน</span>
</div>
```

### ๐ด ุจุทุงูุงุช ุงููุฑููุงุช
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ ุตูุฑุฉ ุงููููุฉ      [ูุชููุฑ] โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ [๐๏ธ ุนุฑุถ] [๐ฅ ุชูุฒูู] [๐๏ธ ุญุฐู] โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ุงูุฅุญุตุงุฆูุงุช

| ุงููููุงุณ | ุงููููุฉ |
|---------|--------|
| **ุฃููุงุน ุงููุฑููุงุช ุงููุฏุนููุฉ** | 4 |
| **ุงูุญุฏ ุงูุฃูุตู ูุญุฌู ุงูููู** | 5 MB |
| **ุฃููุงุน ุงููููุงุช** | ุตูุฑ + PDF |
| **ุนุฏุฏ APIs ุงูุฌุฏูุฏุฉ** | 3 (ุฑูุนุ ุนุฑุถุ ุญุฐู) |
| **ุงูุฃุณุทุฑ ุงููุถุงูุฉ** | 597 |
| **ููุช ุงูุชุทููุฑ** | ~3 ุณุงุนุงุช |
| **ุญุงูุฉ ุงูุงูุชูุงู** | โ 100% |

---

## ๐ง APIs ุงููุณุชุฎุฏูุฉ

### 1. ุฑูุน ููู
```http
POST /api/attachments/upload
Content-Type: multipart/form-data

{
  "file": File,
  "request_id": "15",
  "attachment_type": "id" | "salary" | "bank_statement" | "additional"
}

Response:
{
  "success": true,
  "url": "/api/attachments/view/15/id_1734302456789.jpg",
  "filename": "15/id_1734302456789.jpg"
}
```

### 2. ุนุฑุถ/ุชูุฒูู ููู
```http
GET /api/attachments/view/{request_id}/{filename}

Response: File stream (image/jpeg, application/pdf, etc.)
```

### 3. ุญุฐู ููู
```http
DELETE /api/attachments/delete/{request_id}/{filename}

Response:
{
  "success": true
}
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### โ ุงุฎุชุจุงุฑุงุช ุชูุช
1. **ุฑูุน ุงููููุงุช**:
   - โ ุฑูุน ุตูุฑุฉ JPEG/PNG
   - โ ุฑูุน ููู PDF
   - โ ุฑูุน ูููุงุช ูุชุนุฏุฏุฉ
   - โ ุงูุชุญูู ูู ุงูุญุฌู (ุฑูุถ ููู > 5MB)
   - โ ูุนุงููุฉ ุงูุตูุฑ

2. **ุนุฑุถ ุงููููุงุช**:
   - โ ุนุฑุถ ุงูุตูุฑ ูู ูุงูุฐุฉ ุฌุฏูุฏุฉ
   - โ ุชูุฒูู ุงููููุงุช
   - โ ุนุฑุถ ุจุทุงูุงุช ุงููุฑููุงุช ูู ุตูุญุฉ ุงูุชูุงุตูู

3. **ุญุฐู ุงููููุงุช**:
   - โ ูุทุงูุจุฉ ุงูุชุฃููุฏ
   - โ ุญุฐู ูู R2
   - โ ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช
   - โ ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ

---

## ๐ ุงูุฑูุงุจุท

- **ุงูุญุงุณุจุฉ ุงูุชูุงุนููุฉ**: `/calculator`
- **ุตูุญุฉ ุชูุงุตูู ุงูุทูุจ**: `/admin/requests/:id`
- **ููุญุฉ ุงูุชุญูู**: `/admin`

---

## ๐ ููุงุญุธุงุช ููุฅูุชุงุฌ

### โ๏ธ ูุชุทูุจุงุช ุงููุดุฑ ุนูู Cloudflare Pages

1. **ุฅูุดุงุก R2 Bucket**:
   ```bash
   npx wrangler r2 bucket create tamweel-attachments
   ```

2. **ุชุญุฏูุซ `wrangler.jsonc`**:
   ```jsonc
   {
     "r2_buckets": [
       {
         "binding": "ATTACHMENTS",
         "bucket_name": "tamweel-attachments"
         // ุญุฐู preview_bucket_name ููุฅูุชุงุฌ
       }
     ]
   }
   ```

3. **ุงููุดุฑ**:
   ```bash
   npm run build
   npx wrangler pages deploy dist --project-name tamweel-calc
   ```

### ๐ ุงูุฃูุงู
- โ ุงูุชุญูู ูู ุญุฌู ุงูููู (ููุน ุงููููุงุช ุงููุจูุฑุฉ)
- โ ุงูุชุญูู ูู ููุน ุงูููู (ุตูุฑ ูPDF ููุท)
- โ ุฃุณูุงุก ูููุงุช ูุฑูุฏุฉ (timestamp-based)
- โ ุชุฃููุฏ ุงููุณุชุฎุฏู ูุจู ุงูุญุฐู

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

1. **src/smart-calculator.ts** (597 ุณุทุฑ):
   - ุฅุถุงูุฉ ุฏุงูุฉ `previewFile()`
   - ุชุญุณูู ูููุฐุฌ ุฑูุน ุงููููุงุช
   - ุดุฑูุท ุงูุชูุฏู ููุฑูุน

2. **src/index.tsx** (120 ุณุทุฑ):
   - ุชุญุณูู API ุงูุญุฐู
   - ุชุญุฏูุซ ุตูุญุฉ ุชูุงุตูู ุงูุทูุจ
   - ุฅุถุงูุฉ ุฏุงูุฉ `deleteAttachment()`

3. **wrangler.jsonc**:
   - ุฅุนุฏุงุฏ R2 buckets

---

## ๐ ุงูุฅูุฌุงุฒุงุช ุงูุฑุฆูุณูุฉ

โ **ูุธุงู ุฑูุน ูุชูุงูู** - 4 ุฃููุงุน ูุฑููุงุช
โ **ูุนุงููุฉ ุชููุงุฆูุฉ** - ุตูุฑ ูPDF
โ **ุงูุชุญูู ูู ุงูุตูุงุญูุฉ** - ุญุฌู ูููุน
โ **ุดุฑูุท ุชูุฏู ูุฑุฆู** - ููู ููู
โ **ุนุฑุถ ุงุญุชุฑุงูู** - ุจุทุงูุงุช ููููุฉ
โ **ุญุฐู ุขูู** - ูุน ุชุฃููุฏ
โ **API ูุญุณูู** - ูุนุงูุฌุฉ ุฃุฎุทุงุก ุดุงููุฉ
โ **ุชุฎุฒูู R2** - ุณุฑูุน ูุขูู

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉ: ูุธุงู ุงูุฅุดุนุงุฑุงุช (2-3 ุฃูุงู)
- ๐ง ุฅุดุนุงุฑุงุช ุฏุงุฎู ุงููุธุงู
- ๐ฑ ุฅุดุนุงุฑุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- ๐ ุชูุจููุงุช ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ
- ๐ ูุฑูุฒ ุงูุฅุดุนุงุฑุงุช

### ุงููุฑุญูุฉ ุงูุฎุงูุณุฉ: ุชุญุณููุงุช ุฅุถุงููุฉ
- ๐ ุชูุงุฑูุฑ ูุชูุฏูุฉ
- ๐ ุชุญูููุงุช ุชูุตูููุฉ
- ๐จ ุชุญุณููุงุช UX
- ๐ ุตูุงุญูุงุช ูุชูุฏูุฉ

---

## ๐ ููุฎุต ุงูุฌูุณุฉ

| ุงูุฌุงูุจ | ุงูุชูุงุตูู |
|--------|----------|
| **ุงููุฑุญูุฉ** | ุงูุซุงูุซุฉ - ูุธุงู ุงููุฑููุงุช ุงููุงูู |
| **ุงูุญุงูุฉ** | โ ููุชูู 100% |
| **ุงูููุช ุงููุณุชุบุฑู** | ~3 ุณุงุนุงุช |
| **ุงููููุงุช ุงููุนุฏูุฉ** | 3 ูููุงุช |
| **ุงูุฃุณุทุฑ ุงููุถุงูุฉ** | 597+ |
| **Commits** | 2 |
| **ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ** | 7 ููุฒุงุช ุฑุฆูุณูุฉ |
| **APIs ุงูุฌุฏูุฏุฉ** | 3 |
| **ุงูุชูููู** | โญโญโญโญโญ (5/5) |

---

**ุชู ุงูุฅูุฌุงุฒ ุจูุฌุงุญ! ๐**

ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ูุงูุงุฎุชุจุงุฑ. ุฌููุน ุงูููุฒุงุช ุชุนูู ุจุดูู ูุงูู ููุชูุงูู ูุน ุงููุธุงู ุงููุงุฆู.
